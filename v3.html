<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VAST Ad Compatible Video Player</title>
  <style>
    #video-container {
      position: relative;
      width: 640px;
      height: 360px;
      background-color: black;
    }
    video {
      width: 100%;
      height: 100%;
    }
    #ad-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="video-container">
    <video id="content-video" controls playsinline>
  <source src="video.mp4" type="video/mp4" />
  Your browser does not support the video tag.
</video>
    <div id="ad-container"></div>
  </div>

  <script src="https://imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
  <script>
    const contentVideo = document.getElementById('content-video');
    const adContainer = document.getElementById('ad-container');

    // VAST Ad Tag URL (your provided URL)
    const vastAdTagUrl = "https://impracticalshoulder.com/dPm.FGzidLGQNtv/ZGGLUk/_eqmb9SuuZ_U/ltkmPUTHYo2CNmz/I/3hMrTEkdt/NEjpY/3AMQjGc/yYMJCWZ/sUarWd1upSdCDI0/x-";

    let adDisplayContainer;
    let adsLoader;
    let adsManager;

    function initIMA() {
      // Create the ad display container.
      adDisplayContainer = new google.ima.AdDisplayContainer(adContainer, contentVideo);

      // Initialize the container. Must be done via a user action on mobile devices.
      adDisplayContainer.initialize();

      // Create ads loader.
      adsLoader = new google.ima.AdsLoader(adDisplayContainer);

      // Listen and respond to ads loaded and error events.
      adsLoader.addEventListener(
        google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,
        onAdsManagerLoaded,
        false
      );
      adsLoader.addEventListener(
        google.ima.AdErrorEvent.Type.AD_ERROR,
        onAdError,
        false
      );

      // Request video ads.
      const adsRequest = new google.ima.AdsRequest();
      adsRequest.adTagUrl = vastAdTagUrl;

      // Specify the linear and nonlinear slot sizes. This helps the SDK to size ads appropriately.
      adsRequest.linearAdSlotWidth = 640;
      adsRequest.linearAdSlotHeight = 360;
      adsRequest.nonLinearAdSlotWidth = 640;
      adsRequest.nonLinearAdSlotHeight = 150;

      adsLoader.requestAds(adsRequest);
    }

    function onAdsManagerLoaded(adsManagerLoadedEvent) {
      // Get the ads manager.
      adsManager = adsManagerLoadedEvent.getAdsManager(contentVideo);

      // Add listeners to the required events.
      adsManager.addEventListener(
        google.ima.AdErrorEvent.Type.AD_ERROR,
        onAdError
      );
      adsManager.addEventListener(
        google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,
        onContentPauseRequested
      );
      adsManager.addEventListener(
        google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,
        onContentResumeRequested
      );

      try {
        // Initialize the ads manager. Ad rules playlist can be loaded and rendered after this.
        adsManager.init(640, 360, google.ima.ViewMode.NORMAL);
        adsManager.start();
      } catch (adError) {
        console.error('AdsManager could not start:', adError);
        contentVideo.play();
      }
    }

    function onAdError(adErrorEvent) {
      console.error('Ad error:', adErrorEvent.getError());
      if (adsManager) {
        adsManager.destroy();
      }
      contentVideo.play();
    }

    function onContentPauseRequested() {
      contentVideo.pause();
    }

    function onContentResumeRequested() {
      contentVideo.play();
    }

    // Start ad playback on user interaction (required by mobile browsers).
    contentVideo.addEventListener('play', () => {
      if (!adDisplayContainer) {
        initIMA();
      }
    });

    // Optional: load and play content video if you want.
    contentVideo.src = "/main_Resource/ads/video ads/The_Bread_-_Animated_Short_Film_by_GULU(360p).mp4";
  </script>
  <script src="https://imasdk.googleapis.com/js/sdkloader/ima3_debug.js"></script>
</body>
</html>